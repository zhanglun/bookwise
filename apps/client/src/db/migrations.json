[{"sql":["DO $$ BEGIN\n CREATE TYPE \"public\".\"format\" AS ENUM('EPUB', 'PDF', 'MOBI', 'TEXT', 'UNKNOWN');\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nCREATE TABLE IF NOT EXISTS \"authors\" (\n\t\"uuid\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"name\" varchar DEFAULT '',\n\t\"created_at\" timestamp with time zone DEFAULT now(),\n\t\"updated_at\" timestamp with time zone\n);\n","\nCREATE TABLE IF NOT EXISTS \"book_authors\" (\n\t\"book_uuid\" uuid,\n\t\"author_uuid\" uuid\n);\n","\nCREATE TABLE IF NOT EXISTS \"book_caches\" (\n\t\"book_uuid\" uuid,\n\t\"is_active\" integer DEFAULT 0\n);\n","\nCREATE TABLE IF NOT EXISTS \"book_publishers\" (\n\t\"book_uuid\" uuid,\n\t\"publisher_uuid\" uuid\n);\n","\nCREATE TABLE IF NOT EXISTS \"books\" (\n\t\"uuid\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"title\" varchar(256) DEFAULT '',\n\t\"identifier\" varchar(256) DEFAULT '',\n\t\"subject\" varchar(256) DEFAULT '',\n\t\"description\" text DEFAULT '',\n\t\"contributor\" varchar(256) DEFAULT '',\n\t\"source\" varchar(256) DEFAULT '',\n\t\"format\" \"format\",\n\t\"page_count\" integer,\n\t\"isbn\" varchar(20),\n\t\"path\" varchar(256),\n\t\"publish_at\" timestamp with time zone,\n\t\"created_at\" timestamp with time zone DEFAULT now(),\n\t\"updated_at\" timestamp with time zone,\n\t\"language_uuid\" uuid\n);\n","\nCREATE TABLE IF NOT EXISTS \"languages\" (\n\t\"uuid\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"name\" varchar(50),\n\t\"code\" varchar(10)\n);\n","\nCREATE TABLE IF NOT EXISTS \"publishers\" (\n\t\"uuid\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"name\" varchar DEFAULT '',\n\t\"address\" varchar(255),\n\t\"created_at\" timestamp with time zone DEFAULT now(),\n\t\"updated_at\" timestamp with time zone\n);\n","\nDO $$ BEGIN\n ALTER TABLE \"book_authors\" ADD CONSTRAINT \"book_authors_book_uuid_books_uuid_fk\" FOREIGN KEY (\"book_uuid\") REFERENCES \"public\".\"books\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"book_authors\" ADD CONSTRAINT \"book_authors_author_uuid_authors_uuid_fk\" FOREIGN KEY (\"author_uuid\") REFERENCES \"public\".\"authors\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"book_caches\" ADD CONSTRAINT \"book_caches_book_uuid_books_uuid_fk\" FOREIGN KEY (\"book_uuid\") REFERENCES \"public\".\"books\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"book_publishers\" ADD CONSTRAINT \"book_publishers_book_uuid_books_uuid_fk\" FOREIGN KEY (\"book_uuid\") REFERENCES \"public\".\"books\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"book_publishers\" ADD CONSTRAINT \"book_publishers_publisher_uuid_publishers_uuid_fk\" FOREIGN KEY (\"publisher_uuid\") REFERENCES \"public\".\"publishers\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"books\" ADD CONSTRAINT \"books_language_uuid_languages_uuid_fk\" FOREIGN KEY (\"language_uuid\") REFERENCES \"public\".\"languages\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n"],"bps":true,"folderMillis":1746451366754,"hash":"0d53307b9ae4389c13a0e261a93c07338e3b09c8c5f24fb0b56bbd7f11a0516b"},{"sql":["CREATE TABLE IF NOT EXISTS \"covers\" (\n\t\"uuid\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"book_uuid\" uuid,\n\t\"data\" text DEFAULT '' NOT NULL\n);\n","\nDO $$ BEGIN\n ALTER TABLE \"covers\" ADD CONSTRAINT \"covers_book_uuid_books_uuid_fk\" FOREIGN KEY (\"book_uuid\") REFERENCES \"public\".\"books\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n"],"bps":true,"folderMillis":1747059382430,"hash":"09c3ae6fce91837412587f36d60b28bfc8028d45d6cf66cec04792d21412359c"},{"sql":["CREATE TABLE IF NOT EXISTS \"book_covers\" (\n\t\"book_uuid\" uuid,\n\t\"cover_uuid\" uuid\n);\n","\nALTER TABLE \"covers\" DROP CONSTRAINT \"covers_book_uuid_books_uuid_fk\";\n","\nDO $$ BEGIN\n ALTER TABLE \"book_covers\" ADD CONSTRAINT \"book_covers_book_uuid_books_uuid_fk\" FOREIGN KEY (\"book_uuid\") REFERENCES \"public\".\"books\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"book_covers\" ADD CONSTRAINT \"book_covers_cover_uuid_covers_uuid_fk\" FOREIGN KEY (\"cover_uuid\") REFERENCES \"public\".\"covers\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nALTER TABLE \"covers\" DROP COLUMN IF EXISTS \"book_uuid\";"],"bps":true,"folderMillis":1747060143681,"hash":"26b8b1a9cfcb60aac67fb854516ef23dfb5811a7db4a7a32ac4a8454d1912e1e"}]