[{"sql":["DO $$ BEGIN\n CREATE TYPE \"public\".\"format\" AS ENUM('EPUB', 'PDF', 'MOBI', 'TEXT', 'UNKNOWN');\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nCREATE TABLE IF NOT EXISTS \"authors\" (\n\t\"uuid\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"name\" varchar DEFAULT '',\n\t\"created_at\" timestamp with time zone DEFAULT now(),\n\t\"updated_at\" timestamp with time zone\n);\n","\nCREATE TABLE IF NOT EXISTS \"book_authors\" (\n\t\"book_uuid\" uuid,\n\t\"author_uuid\" uuid\n);\n","\nCREATE TABLE IF NOT EXISTS \"book_caches\" (\n\t\"book_uuid\" uuid,\n\t\"is_active\" integer DEFAULT 0\n);\n","\nCREATE TABLE IF NOT EXISTS \"book_publishers\" (\n\t\"book_uuid\" uuid,\n\t\"publisher_uuid\" uuid\n);\n","\nCREATE TABLE IF NOT EXISTS \"books\" (\n\t\"uuid\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"title\" varchar(256) DEFAULT '',\n\t\"identifier\" varchar(256) DEFAULT '',\n\t\"subject\" varchar(256) DEFAULT '',\n\t\"description\" text DEFAULT '',\n\t\"contributor\" varchar(256) DEFAULT '',\n\t\"source\" varchar(256) DEFAULT '',\n\t\"format\" \"format\",\n\t\"page_count\" integer,\n\t\"isbn\" varchar(20),\n\t\"path\" varchar(256),\n\t\"publish_at\" timestamp with time zone,\n\t\"created_at\" timestamp with time zone DEFAULT now(),\n\t\"updated_at\" timestamp with time zone,\n\t\"language_uuid\" uuid,\n\tCONSTRAINT \"books_title_unique\" UNIQUE(\"title\")\n);\n","\nCREATE TABLE IF NOT EXISTS \"languages\" (\n\t\"uuid\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"name\" varchar(50),\n\t\"code\" varchar(10)\n);\n","\nCREATE TABLE IF NOT EXISTS \"publishers\" (\n\t\"uuid\" uuid PRIMARY KEY DEFAULT gen_random_uuid() NOT NULL,\n\t\"name\" varchar DEFAULT '',\n\t\"address\" varchar(255),\n\t\"created_at\" timestamp with time zone DEFAULT now(),\n\t\"updated_at\" timestamp with time zone\n);\n","\nDO $$ BEGIN\n ALTER TABLE \"book_authors\" ADD CONSTRAINT \"book_authors_book_uuid_books_uuid_fk\" FOREIGN KEY (\"book_uuid\") REFERENCES \"public\".\"books\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"book_authors\" ADD CONSTRAINT \"book_authors_author_uuid_authors_uuid_fk\" FOREIGN KEY (\"author_uuid\") REFERENCES \"public\".\"authors\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"book_caches\" ADD CONSTRAINT \"book_caches_book_uuid_books_uuid_fk\" FOREIGN KEY (\"book_uuid\") REFERENCES \"public\".\"books\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"book_publishers\" ADD CONSTRAINT \"book_publishers_book_uuid_books_uuid_fk\" FOREIGN KEY (\"book_uuid\") REFERENCES \"public\".\"books\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"book_publishers\" ADD CONSTRAINT \"book_publishers_publisher_uuid_publishers_uuid_fk\" FOREIGN KEY (\"publisher_uuid\") REFERENCES \"public\".\"publishers\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"books\" ADD CONSTRAINT \"books_language_uuid_languages_uuid_fk\" FOREIGN KEY (\"language_uuid\") REFERENCES \"public\".\"languages\"(\"uuid\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n"],"bps":true,"folderMillis":1728218178835,"hash":"1386816bc6420389bbed73b54cdaf040aa812d503917bd85220590fd6943fd01"},{"sql":["ALTER TABLE \"books\" DROP CONSTRAINT \"books_title_unique\";"],"bps":true,"folderMillis":1728464083732,"hash":"97074091b0cc472f381fe3a1760ed92d9b1e9e76c4df8ce7c350ae85df483e75"}]